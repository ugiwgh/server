SET @old_max_binlog_size= @@global.max_binlog_size;
SET GLOBAL max_binlog_size= 4096;
call mtr.add_suppression("Can't init tc log");
call mtr.add_suppression("Aborting");
RESET MASTER;
CREATE TABLE t1 (a INT PRIMARY KEY, b MEDIUMTEXT) ENGINE=Innodb;
INSERT INTO t1 VALUES (1, REPEAT("x", 4100));
CREATE TABLE t2 (a INT PRIMARY KEY, b MEDIUMTEXT) ENGINE=Innodb;
show binary logs;
Log_name	File_size
master-bin.000001	#
master-bin.000002	#
# Kill the server
"Zero records should be there."
SELECT COUNT(*) FROM t1;
COUNT(*)
1
show binary logs;
Log_name	File_size
master-bin.000001	#
master-bin.000002	#
master-bin.000003	#
master-bin.000004	#
DROP TABLE t1,t2;
call mtr.add_suppression("Can't init tc log");
call mtr.add_suppression("Aborting");
RESET MASTER;
CREATE TABLE t1 (a INT PRIMARY KEY, b MEDIUMTEXT) ENGINE=Innodb;
CREATE TABLE t2 (a INT PRIMARY KEY, b MEDIUMTEXT) ENGINE=Innodb;
show binary logs;
Log_name	File_size
master-bin.000001	#
# Kill the server
"Zero records should be there."
SELECT COUNT(*) FROM t1;
COUNT(*)
0
SHOW TABLES;
Tables_in_test
t1
t2
DROP TABLE t1,t2;
